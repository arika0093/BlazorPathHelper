### Minimal Usage

Here are the essential steps you need to follow:

* Create a class with the `#!csharp [BlazorPath]` attribute. When defining the class, use the `#!csharp partial` keyword.
* Within this class, define a constant member of type `#!csharp const string`.
* Add the `#!csharp [Query<QueryClass>]` attribute to this member.

During the URL construction process, functions that support query parameters will be generated based on the `#!csharp [Query<QueryClass>]` definition.

```csharp title="WebPaths.cs"
[BlazorPath]
public partial class WebPaths
{
  [Query<QueryRecord>]
  public const string CounterWithQuery = "/counter/query";
}

public record QueryRecord(string query = "hello", int page = 0, bool? opt = null);
```

!!! warning "Important!"

    The `QueryRecord` class must be written in a `.cs` file.
    Due to limitations of the SourceGenerator, it cannot be written in a `.razor` file.

!!! note "Recommendation: Specify Default Values"

    It is recommended to specify default values for each parameter or make them nullable. (This accounts for cases where query parameters are not specified)

??? abstract "Generated Code"

    ```csharp title="Auto Generated Code"
    // <auto-generated />
    public partial class WebPaths
    {
      public partial class Helper
      {
        public static string CounterWithQuery(QueryRecord __query)
          => string.Format("/counter/query{0}", BuildQuery([
            ToEscapedStrings("query", __query.query),
            ToEscapedStrings("page", __query.page),
            ToEscapedStrings("opt", __query.opt)
          ]));
      }
    }
    ```

### How It Works

For members with the `#!csharp [Query<QueryClass>]` attribute, the following function is generated:

```csharp title="Auto Generated Code"
public static string CounterWithQuery(QueryRecord __query)
  => string.Format("/counter/query{0}", BuildQuery([
    ToEscapedStrings("query", __query.query),
    ToEscapedStrings("page", __query.page),
    ToEscapedStrings("opt", __query.opt)
  ]));
```

From the generated code above, you can see that each property of the `QueryRecord` class is expanded into query parameters. When generating this function, the BlazorPathHelper performs the following:

1. Checks if the `#!csharp [Page<QueryClass>]` attribute is attached.
2. If specified, it extracts the properties defined in `QueryClass`.
    - Members can also be used, but it is not recommended.
3. Calls the `ToEscapedStrings` function for each property to generate query parameters.
    - For example, in the above case, it generates strings like `#!csharp "query=hello"`, `#!csharp "page=0"`, `#!csharp "opt=true"`.
4. Passes the generated query parameters to the `BuildQuery` function to create the query string.
    - In the above case, it generates a string like `#!csharp "?query=hello&page=0&opt=true"`.
    - If `opt=null`, it becomes `#!csharp "?query=hello&page=0"`, and the `opt` parameter is not included.

!!! tip "Nested Properties Not Supported"

    As defined above, it does not actually restore the entire class but extracts properties. Therefore, nested properties are not supported at this time.

### Changing Query Names

When specifying the `#!csharp [Query<QueryRecord>]` attribute, the query name directly uses the property name of `QueryRecord`. If you want to change the query name, add the `#!csharp [QueryName("shortName")]` attribute.

```csharp title="WebPaths.cs"
public record QueryRecord
{
    [QueryName("short")] // or [SupplyParameterFromQuery(Name = "short")]
    public required string SuperLongName { get; set; }
}

[BlazorPath]
public partial class WebPaths
{
    [Query<QueryRecord>]
    public const string QueryTest = "/query-test";
      // -> /query-test?short=hello
}
```

### Supported Types

Properties of `QueryClass` can be defined as follows:

#### Basic Types

| Class Definition Example                      | Example of Output Query URL     |
| --------------------------------------------- | ------------------------------- |
| `#!csharp record QueryClass(int val1)`        | `#!csharp "/?val1=5"`           |
| `#!csharp record QueryClass(bool? flg1)`      | `#!csharp "/?flg1=true", "/"`   |

In addition to these, any type that implements `#!csharp ToString()` and can be restored by Blazor is generally supported.

#### Arrays

| Class Definition Example                      | Example of Output Query URL     |
| --------------------------------------------- | ------------------------------- |
| `#!csharp record QueryClass(string[] arr)`    | `#!csharp "/?arr=foo&arr=bar&arr=buz"`|

Besides `#!csharp string[]`, types like `#!csharp int[]` and `#!csharp bool[]` are also supported. However, since Blazor does not support `IEnumerable` and `List`, these types are not supported.